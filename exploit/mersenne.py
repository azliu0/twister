from pwn import *
from mt19937predictor import MT19937Predictor

exe = './mersenne'
context.binary = ELF(exe, checksec=False)
context.log_level = 'debug'
io = process(exe)

predictor = MT19937Predictor()

for _ in range(624):
    x = int(io.recvline())
    predictor.setrandbits(x,32)

for _ in range(1000 - 624):
    x = int(io.recvline())
    assert x == predictor.getrandbits(32)

io.interactive()
